-- 持有金额Top100钱包数据

-- NFT API数据表结构定义和数据导入

-- 设置执行参数
SET 'execution.checkpointing.interval' = '10s';
SET 'table.exec.state.ttl'= '8640000';
SET 'table.local-time-zone' = 'Asia/Shanghai';

/* 创建Paimon Catalog */
CREATE CATALOG paimon_hive WITH (
    'type' = 'paimon',
    'metastore' = 'hive',
    'uri' = 'thrift://192.168.254.133:9083',
    'hive-conf-dir' = '/opt/software/apache-hive-3.1.3-bin/conf',
    'hadoop-conf-dir' = '/opt/software/hadoop-3.1.3/etc/hadoop',
    'warehouse' = 'hdfs:////user/hive/warehouse'
);

USE CATALOG paimon_hive;
CREATE DATABASE IF NOT EXISTS ods;
USE ods;


-- 持有金额Top100钱包
CREATE TABLE IF NOT EXISTS ods_top100_balance_wallets (
    rank_date STRING,
    account_address STRING,
    rank_num INT,
    holding_volume DOUBLE,
    buy_volume DOUBLE,
    sell_volume DOUBLE,
    realized_gains_volume DOUBLE,
    holding_collections BIGINT,
    holding_nfts BIGINT,
    trade_count BIGINT,
    PRIMARY KEY (rank_date, account_address) NOT ENFORCED
) WITH (
    'bucket' = '4',
    'bucket-key' = 'account_address',
    'file.format' = 'parquet',
    'merge-engine' = 'deduplicate',
    'changelog-producer' = 'input',
    'compaction.min.file-num' = '5',
    'compaction.max.file-num' = '50',
    'compaction.target-file-size' = '128MB'
);

-- 插入数据
INSERT INTO ods_top100_balance_wallets (
    rank_date,
    account_address,
    rank_num,
    holding_volume,
    buy_volume,
    sell_volume,
    realized_gains_volume,
    holding_collections,
    holding_nfts,
    trade_count
) VALUES
('2025-04-19', '0xab14624691d0d1b62f9797368104ef1f8c20df83', 1, 64785.001, 0, 0, 0, 3, 4815, 7459),('2025-04-19', '0xf8d0a4542b1277d8a330e69cc56bdc109029c623', 2, 45272.3697, 724.81, 1161.81, 437, 1363, 10487, 28931),('2025-04-19', '0x7ec2b8003e8066074364fb31aa0501112508e97e', 3, 44005.0864, 122.5, 107.71, -14.79, 517, 1709, 2393),('2025-04-19', '0xe052113bd7d7700d623414a0a4585bcae754e9d5', 4, 42181.6277, 15621.44, 0, -15621.44, 4157, 159860, 595358),('2025-04-19', '0xb7f7f6c52f2e2fdb1963eab30438024864c313f6', 5, 27133.0644, 0, 0, 0, 59, 2332, 11476),('2025-04-19', '0x620b70123fb810f6c653da7644b5dd0b6312e4d8', 6, 22819.024, 0, 0, 0, 102, 10328, 40038),('2025-04-19', '0xa858ddc0445d8131dac4d1de01f834ffcba52ef1', 7, 20383.3523, 0.03, 0, -0.03, 336, 47679, 135846),('2025-04-19', '0x4687f6b19b5ceea0cd50eca6711127b23602deac', 8, 20017.6544, 433.8, 578.91, 145.11, 345, 4572, 17724),('2025-04-19', '0x29469395eaf6f95920e59f858042f0e28d98a20b', 9, 13480.8898, 112570.96, 1362123.39, 1249552.43, 89, 4171, 707466),('2025-04-19', '0xb88f61e6fbda83fbfffabe364112137480398018', 10, 12425.0114, 669.8, 0, -669.8, 1346, 21320, 29793),('2025-04-19', '0xf7efe5fdaa7030ee8ed482ba755b664c32220d00', 11, 12015.3114, 25.78, 9.97, -15.81, 42, 1011, 1519),('2025-04-19', '0x88978552a1b63992bbf23a9ee6b8757076250eb1', 12, 12011.0084, 2.44, 6.49, 4.05, 288, 1071, 1775),('2025-04-19', '0x8ae57a027c63fca8070d1bf38622321de8004c67', 13, 11141.248, 2763.48, 96, -2667.48, 774, 30623, 95166),('2025-04-19', '0x76951f6e84213f189fee1524d382b312dfd85ebc', 14, 11030.3928, 134.67, 141.07, 6.4, 484, 3405, 9285),('2025-04-19', '0x000000000000003607fce1ac9e043a86675c5c2f', 15, 8652, 0, 0, 0, 2, 207, 1189),('2025-04-19', '0x67e1ecfa9232e27eaf3133b968a33a9a0dca9e16', 16, 7482.579, 0, 0, 0, 3, 3411, 12120),('2025-04-19', '0xeb156caa9f0a48300f953b924f4632f39cc929c6', 17, 7037.3552, 1436.75, 1048.53, -388.22, 701, 1945, 7428),('2025-04-19', '0xd416e09795d24216a4548b70964c7f9d95a7293f', 18, 6501.332, 54.21, 65.22, 11.01, 87, 7569, 11746),('2025-04-19', '0x8a7b802bbf5bb75dd1d491251a01eae2646a5ad2', 19, 6441.7382, 969.42, 1094.43, 125.01, 576, 2943, 16687),('2025-04-19', '0x2238c8b16c36628b8f1f36486675c1e2a30debf1', 20, 6421.6449, 334.37, 4953.54, 4619.17, 67, 1071, 1391),('2025-04-19', '0x577ebc5de943e35cdf9ecb5bbe1f7d7cb6c7c647', 21, 6285.6533, 2783.84, 15700.73, 12916.89, 1875, 16487, 41762),('2025-04-19', '0x69021ae8769586d56791d29615959997c2012b99', 22, 6183.9281, 3.82, 401, 397.18, 1317, 5776, 10409),('2025-04-19', '0xa25803ab86a327786bb59395fc0164d826b98298', 23, 6044.4805, 477.65, 6785.91, 6308.26, 1416, 9920, 15633),('2025-04-19', '0x1acc948a79c9d185297d8ca2ea6e80e3959c57dd', 24, 6032.2277, 1.11, 3.43, 2.32, 428, 1394, 1760),('2025-04-19', '0x26f744711ee9e5079cbeaf318ba8a8e938844de6', 25, 5922.5957, 0.02, 0, -0.02, 91, 936, 1063),('2025-04-19', '0x6ba49f917b2adde6e2c286311d494db9fa34ba42', 26, 5874.0722, 2.32, 0.13, -2.19, 9, 453, 511),('2025-04-19', '0xaaa2da255df9ee74c7075bcb6d81f97940908a5d', 27, 5655.469, 1.09, 0, -1.09, 18, 1038, 7360),('2025-04-19', '0x31a5ff62a1b2c0f030aee1661eab6513ae676e23', 28, 5578.8363, 0.01, 650, 649.99, 233, 4105, 4651),('2025-04-19', '0x0bb75bef057da63a0ae4b25fe9adafd35cd92b87', 29, 5020.0314, 140.5, 11.86, -128.64, 759, 2326, 5997),('2025-04-19', '0x2016554065e392d5db0734519a4bc836ccbfe459', 30, 4880.664, 0, 0, 0, 2, 2569, 2763),('2025-04-19', '0x3e83bcef10082eac00346cfcd53886b9ef3d8bbe', 31, 4671.3157, 5.07, 0.5, -4.57, 18, 438, 1640),('2025-04-19', '0x62f9acbd11350fb05b3215507dd1f6e05ed27af5', 32, 4663.5509, 105.84, 24, -81.84, 190, 691, 1066),('2025-04-19', '0x8e04f3f772b4250c060e1b87fd28e420999699e7', 33, 4656.3292, 72.15, 63.34, -8.81, 77, 8260, 12447),('2025-04-19', '0xf68e4d63c8ea83083d1cb9858210cf2b03d8266b', 34, 4618.263, 15.01, 0, -15.01, 502, 4655, 8031),('2025-04-19', '0x0232d1083e970f0c78f56202b9a666b526fa379f', 35, 4538.197, 28827.81, 79223.04, 50395.23, 112, 332, 4497),('2025-04-19', '0x3a4894f709544e5a3289d55c3b7f988839362712', 36, 4522.6836, 19.28, 32.86, 13.58, 1313, 6506, 10118),('2025-04-19', '0xd1102a265c1325059e72797f71be37481db1e588', 37, 4363.8893, 43.02, 0, -43.02, 31, 1027, 1053),('2025-04-19', '0x9882c6fd5f72df2fb1fbd00871cd124b3d427fd2', 38, 4272, 0, 0, 0, 1, 712, 712),('2025-04-19', '0x3f22fc93143790a1bd11c37c65a0a0f7e7875ea2', 39, 4187.3676, 0, 0, 0, 16, 541, 551),('2025-04-19', '0x4084df8bf74ba73f04eb39b89df698608df7f4b5', 40, 4173.0197, 0, 0, 0, 208, 2591, 2909),('2025-04-19', '0xe2a83b15fc300d8457eb9e176f98d92a8ff40a49', 41, 3793.1701, 1.52, 0, -1.52, 48, 535, 3768),('2025-04-19', '0x7174039818a41e1ae40fdcfa3e293b0f41592af2', 42, 3789.8222, 13.85, 0, -13.85, 207, 2365, 2647),('2025-04-19', '0x40aaad5197319d1f3043f22250fa78f3095e6913', 43, 3663.0286, 0.77, 0.55, -0.22, 15, 175, 291),('2025-04-19', '0x269616d549d7e8eaa82dfb17028d0b212d11232a', 44, 3192.05, 0, 1604.18, 1604.18, 56, 763, 1669),('2025-04-19', '0x7f5afc67d4c3ae0182354ea6e785fdeb20150f15', 45, 3168.9376, 8.46, 12.25, 3.79, 251, 2044, 3145),('2025-04-19', '0x2f53e033c55eb6c87cea259123c0a68ca3578426', 46, 3054.35, 0, 0, 0, 1, 8255, 16389),('2025-04-19', '0xda86021e5a5370006c4ae6ea74c470878f36a9a3', 47, 3047.3022, 5.71, 13.97, 8.26, 1688, 4866, 6205),('2025-04-19', '0xfd1e3309ea484071377fe17fbfe9c52642eb467f', 48, 3044.944, 4.97, 2.86, -2.11, 291, 860, 1107),('2025-04-19', '0x0afd25e81f126d87bee5347aabbbdbf725f02abd', 49, 3031.7491, 10.28, 54.14, 43.86, 262, 1370, 2716),('2025-04-19', '0x5157ef1e12a8fe5f7e06a38c6c5192f141598fa5', 50, 3015.3297, 8.59, 21.52, 12.93, 1107, 5307, 5984),('2025-04-19', '0xb162c8d70901d39d5edc629abb9da95b1153289a', 51, 3001.3974, 130.38, 146, 15.62, 175, 645, 3581),('2025-04-19', '0x3d5c204c96dbba691a8b8826b5121ec918a727cd', 52, 3000.8217, 20.05, 19.43, -0.62, 258, 331, 972),('2025-04-19', '0x0ddf26c510c2accc60b0551647dda59b7e03f2d0', 53, 2970.9343, 55.64, 130.23, 74.59, 158, 796, 3321),('2025-04-19', '0x8282e91d7a22d9b37a26c4f2ad4bcc690351bf3b', 54, 2970.2043, 74.05, 130.82, 56.77, 61, 371, 1415),('2025-04-19', '0x2687b8f2762d557fbc8cfbb5a73aee71fdd5c604', 55, 2876.9132, 271.54, 490.2, 218.66, 3876, 39539, 49836),('2025-04-19', '0x1c70d0a86475cc707b48aa79f112857e7957274f', 56, 2823.6977, 0, 0, 0, 14, 6214, 36288),('2025-04-19', '0x062c5432107e3b9ad924512209a7468b5c200fcd', 57, 2814.6771, 0.06, 5137.5, 5137.44, 98, 508, 710),('2025-04-19', '0x7760e0243ca9baa630412865df7b39afba42ff0f', 58, 2810.5787, 18.14, 0, -18.14, 198, 1773, 2004),('2025-04-19', '0x9af481276b075e036bc23e887a8bd275e69ef74c', 59, 2575.0579, 255.72, 441.75, 186.03, 375, 1492, 2996),('2025-04-19', '0x6301add4fb128de9778b8651a2a9278b86761423', 60, 2538.0973, 976.48, 2543.63, 1567.15, 1774, 11606, 22279),('2025-04-19', '0x525b8ecd160b60a2a08c4880dfa2a4a3858c0b41', 61, 2508.0436, 79, 66.61, -12.39, 243, 503, 826),('2025-04-19', '0x0008d343091ef8bd3efa730f6aae5a26a285c7a2', 62, 2457.8641, 1945.01, 1474.52, -470.49, 1638, 383108, 403294),('2025-04-19', '0xdde8df9a7dc9f68bdac815f493d1d731de911b5a', 63, 2426.1961, 143.18, 2953.58, 2810.4, 1216, 2603, 7470),('2025-04-19', '0x3eb879cc9a0ef4c6f1d870a40ae187768c278da2', 64, 2423.0793, 0, 0, 0, 47, 1286, 93804),('2025-04-19', '0x728b3de78c3bd3e9c970524ca6aae1f8d6a61996', 65, 2389.3729, 5058.94, 5101.9, 42.96, 307, 5108, 12219),('2025-04-19', '0xf5a4ba515dd36a42e9634a3ac1f1c58fa24d3acd', 66, 2237.5629, 87.74, 223.49, 135.75, 125, 604, 847),('2025-04-19', '0x2a538000a53f38d89f37fa43a301cee2c0f9e331', 67, 2207.2963, 819.08, 689.68, -129.4, 222, 1489, 1689),('2025-04-19', '0x530afa101bed324809d0738d45b38a669314ff54', 68, 2169.7332, 67.15, 41.9, -25.25, 169, 1441, 1534),('2025-04-19', '0x9a15342876e19052c3fabcef9bad8507b9623c12', 69, 2116.1269, 234.7, 189.36, -45.34, 121, 324, 948),('2025-04-19', '0xefcbc56e48d51b9d93d647ba7bfa501eb3aac398', 70, 2107.4318, 87.75, 126.13, 38.38, 1531, 15383, 21701),('2025-04-19', '0xbe2ad1d87b3c783c56de71718588fc4c0ce705b2', 71, 2009.6609, 4.1, 0.18, -3.92, 231, 1372, 2012),('2025-04-19', '0x05f9469db4530d9492af07fb064de2af8c48554a', 72, 2002.4703, 14.62, 6.1, -8.52, 71, 329, 492),('2025-04-19', '0x996e1d4ce3e1e558889832832004b2466153adbe', 73, 1991.5648, 2.32, 50.49, 48.17, 9225, 174360, 190778),('2025-04-19', '0x24e267d13314dd742d86c3321e727b801ed99542', 74, 1976, 0, 0, 0, 51, 99, 427),('2025-04-19', '0x0d388658633418e8e51a7cf67c7059f863f053d9', 75, 1920.6403, 890.06, 433.23, -456.83, 207, 2453, 8759),('2025-04-19', '0xff36ff458b51dcd034598c56f65a8491427dc572', 76, 1891.1075, 0.78, 0.45, -0.33, 60, 357, 445),('2025-04-19', '0x30762e2624c4b97d84bd69ba6527a4c00f30826d', 77, 1888.1574, 312.57, 247.15, -65.42, 71, 335, 525),('2025-04-19', '0xeea89c8843e8beb56e411bb4cac6dbc2d937ee1d', 78, 1887.9638, 0, 109.98, 109.98, 2913, 83845, 85012),('2025-04-19', '0xc896866e927e6f8a416ba209976115e79fa0a66f', 79, 1875.0383, 6.32, 0, -6.32, 52, 2844, 2984),('2025-04-19', '0x2cc12318de28edc9c753f7cb22100890af630c2d', 80, 1850.0089, 0, 0, 0, 59, 297, 327),('2025-04-19', '0xb4d3c81418a32b6c8dbb6462bbed26ab16884e92', 81, 1838.4589, 88.45, 127.86, 39.41, 238, 1393, 5349),('2025-04-19', '0x39fb2a042217ea9e03ec0cc345b5dcf59f17d9f7', 82, 1800.9645, 0.35, 0.56, 0.21, 145, 1307, 1337),('2025-04-19', '0xfa3ce71036dd4564d7d8de19d2b90fb856c5be82', 83, 1796.1033, 0, 0, 0, 3, 1001, 15493),('2025-04-19', '0x4b4b7a4008718415c54e41398448421643b2aa61', 84, 1785.1432, 41.12, 82.01, 40.89, 251, 2394, 4582),('2025-04-19', '0x00b278dd68f9d8491795ffaf771120638bef1686', 85, 1695.0432, 51.89, 5377.61, 5325.72, 833, 3277, 9238),('2025-04-19', '0xe7513e5595a751af9f298ecea7741cdd839dc7d4', 86, 1606.7036, 98.76, 73.58, -25.18, 388, 1406, 3280),('2025-04-19', '0x56fcb471a9dde74045830439ad6612c9aad53c19', 87, 1603.0254, 0.14, 0, -0.14, 56, 749, 813),('2025-04-19', '0xd13f1a15d9815745d071fe812df08cc99c6a728f', 88, 1600.0819, 81.84, 101.15, 19.31, 8, 23, 287),('2025-04-19', '0xcda72070e455bb31c7690a170224ce43623d0b6f', 89, 1590.4583, 10.37, 74869.47, 74859.1, 57699, 251676, 734272),('2025-04-19', '0x98e711f31e49c2e50c1a290b6f2b1e493e43ea76', 90, 1582.8428, 0, 0, 0, 724, 3845, 5261),('2025-04-19', '0x005734d7d408bccf41cff34b46244551d01f0a6b', 91, 1580.5072, 0.31, 0, -0.31, 172, 1273, 1376),('2025-04-19', '0x29f1abd903f2293d062307d1ff4e25697a05986f', 92, 1562.1414, 0, 2.27, 2.27, 257, 870, 1052),('2025-04-19', '0x930dd93a6d35f41fd4addae3d74764517a0d041a', 93, 1555.2331, 0, 0, 0, 11, 18282, 38636),('2025-04-19', '0x020ca66c30bec2c4fe3861a94e4db4a498a35872', 94, 1551.1171, 170874.76, 151421.21, -19453.55, 2447, 15041, 117274),('2025-04-19', '0x3433c2753da24df566ea14c40584179e97396cf3', 95, 1545.0731, 28.13, 46.94, 18.81, 369, 1141, 1889),('2025-04-19', '0x440bcc7a1cf465eafabae301d1d7739cbfe09dda', 96, 1534.2759, 1029.35, 78.44, -950.91, 9, 116, 302),('2025-04-19', '0x0e642e32974470085e362fe76de5c43330632bdb', 97, 1529.99, 57.79, 137.24, 79.45, 404, 5107, 13279),('2025-04-19', '0x5f4934fc98eae6061a01868a4700c53c1ffb7d2e', 98, 1499.9643, 1343.19, 642.01, -701.18, 515, 2515, 5896),('2025-04-19', '0xf52393e120f918ffba50410b90a29b1f8250c879', 99, 1487.0817, 6070.22, 3831.12, -2239.1, 925, 8838, 15113),('2025-04-19', '0x1c593c369136264abfb908b4b20e74c9a5949417', 100, 1472.5484, 1104.84, 0.02, -1104.82, 102, 3308, 4425)
;
