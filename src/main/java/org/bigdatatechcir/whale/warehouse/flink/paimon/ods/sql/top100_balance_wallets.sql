-- 持有金额Top100钱包数据

-- NFT API数据表结构定义和数据导入

-- 设置执行参数
SET 'execution.checkpointing.interval' = '10s';
SET 'table.exec.state.ttl'= '8640000';
SET 'table.local-time-zone' = 'Asia/Shanghai';

/* 创建Paimon Catalog */
CREATE CATALOG paimon_hive WITH (
    'type' = 'paimon',
    'metastore' = 'hive',
    'uri' = 'thrift://192.168.254.133:9083',
    'hive-conf-dir' = '/opt/software/apache-hive-3.1.3-bin/conf',
    'hadoop-conf-dir' = '/opt/software/hadoop-3.1.3/etc/hadoop',
    'warehouse' = 'hdfs:////user/hive/warehouse'
);

USE CATALOG paimon_hive;
CREATE DATABASE IF NOT EXISTS ods;
USE ods;


-- 持有金额Top100钱包
CREATE TABLE IF NOT EXISTS ods_top100_balance_wallets (
    rank_date STRING,
    account_address STRING,
    rank_num INT,
    holding_volume DOUBLE,
    buy_volume DOUBLE,
    sell_volume DOUBLE,
    realized_gains_volume DOUBLE,
    holding_collections BIGINT,
    holding_nfts BIGINT,
    trade_count BIGINT,
    PRIMARY KEY (rank_date, account_address) NOT ENFORCED
) WITH (
    'bucket' = '4',
    'bucket-key' = 'account_address',
    'file.format' = 'parquet',
    'merge-engine' = 'deduplicate',
    'changelog-producer' = 'input',
    'compaction.min.file-num' = '5',
    'compaction.max.file-num' = '50',
    'compaction.target-file-size' = '128MB'
);

-- 插入数据
INSERT INTO ods_top100_balance_wallets (
    rank_date,
    account_address,
    rank_num,
    holding_volume,
    buy_volume,
    sell_volume,
    realized_gains_volume,
    holding_collections,
    holding_nfts,
    trade_count
) VALUES
('2025-04-10', '0xab14624691d0d1b62f9797368104ef1f8c20df83', 1, 64785.003, 0, 0, 0, 3, 4815, 7459),('2025-04-10', '0xf8d0a4542b1277d8a330e69cc56bdc109029c623', 2, 45269.5256, 724.81, 1161.81, 437, 1363, 10487, 28931),('2025-04-10', '0x7ec2b8003e8066074364fb31aa0501112508e97e', 3, 44005.0864, 122.5, 107.71, -14.79, 517, 1709, 2393),('2025-04-10', '0xe052113bd7d7700d623414a0a4585bcae754e9d5', 4, 41513.3756, 15621.44, 0, -15621.44, 4154, 159843, 595229),('2025-04-10', '0xb7f7f6c52f2e2fdb1963eab30438024864c313f6', 5, 27413.556, 0, 0, 0, 60, 2332, 11471),('2025-04-10', '0x620b70123fb810f6c653da7644b5dd0b6312e4d8', 6, 21446.886, 0, 0, 0, 102, 10325, 39955),('2025-04-10', '0xa858ddc0445d8131dac4d1de01f834ffcba52ef1', 7, 20493.8987, 0.03, 0, -0.03, 334, 47672, 135839),('2025-04-10', '0x4687f6b19b5ceea0cd50eca6711127b23602deac', 8, 20017.6544, 433.8, 578.91, 145.11, 345, 4572, 17724),('2025-04-10', '0x29469395eaf6f95920e59f858042f0e28d98a20b', 9, 13579.3123, 112096.19, 1360279.37, 1248183.18, 89, 4289, 705582),('2025-04-10', '0x88978552a1b63992bbf23a9ee6b8757076250eb1', 10, 12011.0084, 2.44, 6.49, 4.05, 288, 1071, 1775),('2025-04-10', '0xb88f61e6fbda83fbfffabe364112137480398018', 11, 11695.665, 669.8, 0, -669.8, 1345, 21319, 29792),('2025-04-10', '0xf7efe5fdaa7030ee8ed482ba755b664c32220d00', 12, 11533.1832, 25.78, 9.97, -15.81, 42, 999, 1507),('2025-04-10', '0x8ae57a027c63fca8070d1bf38622321de8004c67', 13, 11328.7022, 2763.48, 96, -2667.48, 774, 30608, 95051),('2025-04-10', '0x76951f6e84213f189fee1524d382b312dfd85ebc', 14, 11030.3928, 134.67, 141.07, 6.4, 484, 3405, 9285),('2025-04-10', '0x000000000000003607fce1ac9e043a86675c5c2f', 15, 8627.5, 0, 0, 0, 2, 204, 1174),('2025-04-10', '0xeb156caa9f0a48300f953b924f4632f39cc929c6', 16, 7037.3552, 1436.75, 1048.53, -388.22, 701, 1945, 7428),('2025-04-10', '0x44e9d011df8741be2493e99297e9ad67bb1aa85b', 17, 6947.7882, 1096.5, 1483.44, 386.94, 1607, 10011, 27457),('2025-04-10', '0xaaa2da255df9ee74c7075bcb6d81f97940908a5d', 18, 6549.721, 1.09, 0, -1.09, 18, 1253, 7103),('2025-04-10', '0x2238c8b16c36628b8f1f36486675c1e2a30debf1', 19, 6541.4523, 334.37, 4953.54, 4619.17, 66, 1070, 1390),('2025-04-10', '0x8a7b802bbf5bb75dd1d491251a01eae2646a5ad2', 20, 6441.7382, 969.42, 1094.43, 125.01, 576, 2943, 16687),('2025-04-10', '0x577ebc5de943e35cdf9ecb5bbe1f7d7cb6c7c647', 21, 6438.5338, 2783.84, 15700.73, 12916.89, 1874, 16486, 41761),('2025-04-10', '0xd416e09795d24216a4548b70964c7f9d95a7293f', 22, 6298.5694, 54.21, 65.2, 10.99, 87, 7572, 11743),('2025-04-10', '0x69021ae8769586d56791d29615959997c2012b99', 23, 6255.2955, 3.82, 401, 397.18, 1317, 5776, 10409),('2025-04-10', '0x67e1ecfa9232e27eaf3133b968a33a9a0dca9e16', 24, 6180.0489, 0, 0, 0, 3, 3408, 12084),('2025-04-10', '0xa25803ab86a327786bb59395fc0164d826b98298', 25, 6112.3025, 477.65, 6785.91, 6308.26, 1415, 9919, 15632),('2025-04-10', '0x1acc948a79c9d185297d8ca2ea6e80e3959c57dd', 26, 6032.2277, 1.11, 3.43, 2.32, 428, 1394, 1760),('2025-04-10', '0x26f744711ee9e5079cbeaf318ba8a8e938844de6', 27, 5993.1001, 0.02, 0, -0.02, 90, 935, 1062),('2025-04-10', '0x6ba49f917b2adde6e2c286311d494db9fa34ba42', 28, 5874.0722, 2.32, 0.13, -2.19, 9, 453, 511),('2025-04-10', '0x0bb75bef057da63a0ae4b25fe9adafd35cd92b87', 29, 4820.4532, 140.5, 11.86, -128.64, 759, 2324, 5983),('2025-04-10', '0x2016554065e392d5db0734519a4bc836ccbfe459', 30, 4728.7188, 0, 0, 0, 2, 2569, 2763),('2025-04-10', '0x62f9acbd11350fb05b3215507dd1f6e05ed27af5', 31, 4663.5509, 105.84, 24, -81.84, 190, 691, 1066),('2025-04-10', '0xf68e4d63c8ea83083d1cb9858210cf2b03d8266b', 32, 4620.4815, 15.01, 0, -15.01, 502, 4655, 8031),('2025-04-10', '0x0232d1083e970f0c78f56202b9a666b526fa379f', 33, 4549.6945, 28827.81, 79114.1, 50286.29, 112, 331, 4490),('2025-04-10', '0x8e04f3f772b4250c060e1b87fd28e420999699e7', 34, 4526.6475, 72.15, 63.32, -8.83, 77, 8263, 12444),('2025-04-10', '0x3a4894f709544e5a3289d55c3b7f988839362712', 35, 4522.8843, 19.28, 32.86, 13.58, 1313, 6506, 10118),('2025-04-10', '0x3e83bcef10082eac00346cfcd53886b9ef3d8bbe', 36, 4486.1002, 5.07, 0.5, -4.57, 18, 438, 1640),('2025-04-10', '0x9882c6fd5f72df2fb1fbd00871cd124b3d427fd2', 37, 4272, 0, 0, 0, 1, 712, 712),('2025-04-10', '0x4084df8bf74ba73f04eb39b89df698608df7f4b5', 38, 4223.4061, 0, 0, 0, 208, 2591, 2909),('2025-04-10', '0x31a5ff62a1b2c0f030aee1661eab6513ae676e23', 39, 4211.1469, 0.01, 650, 649.99, 233, 4105, 4651),('2025-04-10', '0x694e64d4ad77e0c234b7b1c55ac40302ad86ce3f', 40, 4178.0583, 347.6, 265.5, -82.1, 117, 3214, 8125),('2025-04-10', '0x3f22fc93143790a1bd11c37c65a0a0f7e7875ea2', 41, 4120.751, 0, 0, 0, 14, 538, 548),('2025-04-10', '0xcda72070e455bb31c7690a170224ce43623d0b6f', 42, 4034.8631, 10.37, 74856.74, 74846.37, 57624, 251340, 733036),('2025-04-10', '0x7174039818a41e1ae40fdcfa3e293b0f41592af2', 43, 3835.5817, 13.85, 0, -13.85, 207, 2365, 2647),('2025-04-10', '0x762da606029d3120735aa1eec15464e265db7a3c', 44, 3776.5786, 904.51, 279.17, -625.34, 613, 2482, 3247),('2025-04-10', '0x40aaad5197319d1f3043f22250fa78f3095e6913', 45, 3663.0286, 0.77, 0.55, -0.22, 15, 175, 291),('2025-04-10', '0xe2a83b15fc300d8457eb9e176f98d92a8ff40a49', 46, 3663.0014, 1.52, 0, -1.52, 47, 538, 3763),('2025-04-10', '0x269616d549d7e8eaa82dfb17028d0b212d11232a', 47, 3272.55, 0, 1604.18, 1604.18, 56, 764, 1668),('2025-04-10', '0x461ae8c33224aceb7f1259095dd2a334ad20f322', 48, 3244.9274, 111.23, 158.13, 46.9, 586, 2350, 3133),('2025-04-10', '0x7f5afc67d4c3ae0182354ea6e785fdeb20150f15', 49, 3168.9376, 8.46, 12.25, 3.79, 251, 2044, 3145),('2025-04-10', '0xda86021e5a5370006c4ae6ea74c470878f36a9a3', 50, 3047.3022, 5.71, 13.97, 8.26, 1688, 4866, 6205),('2025-04-10', '0xfd1e3309ea484071377fe17fbfe9c52642eb467f', 51, 3044.944, 4.97, 2.86, -2.11, 291, 860, 1107),('2025-04-10', '0x0afd25e81f126d87bee5347aabbbdbf725f02abd', 52, 3031.7491, 10.28, 54.14, 43.86, 262, 1370, 2716),('2025-04-10', '0x5157ef1e12a8fe5f7e06a38c6c5192f141598fa5', 53, 3015.3297, 8.59, 21.52, 12.93, 1107, 5307, 5984),('2025-04-10', '0xb162c8d70901d39d5edc629abb9da95b1153289a', 54, 3001.3974, 130.38, 146, 15.62, 175, 645, 3581),('2025-04-10', '0x3d5c204c96dbba691a8b8826b5121ec918a727cd', 55, 3000.8217, 20.05, 19.43, -0.62, 258, 331, 972),('2025-04-10', '0x1c70d0a86475cc707b48aa79f112857e7957274f', 56, 2978.8457, 0, 0, 0, 14, 6238, 36218),('2025-04-10', '0x0ddf26c510c2accc60b0551647dda59b7e03f2d0', 57, 2970.9343, 55.64, 130.23, 74.59, 158, 796, 3321),('2025-04-10', '0x8282e91d7a22d9b37a26c4f2ad4bcc690351bf3b', 58, 2970.2043, 74.05, 130.82, 56.77, 61, 371, 1415),('2025-04-10', '0x996e1d4ce3e1e558889832832004b2466153adbe', 59, 2948.7301, 2.32, 50.49, 48.17, 9221, 174280, 190329),('2025-04-10', '0x2687b8f2762d557fbc8cfbb5a73aee71fdd5c604', 60, 2877.6051, 271.54, 490.2, 218.66, 3876, 39539, 49836),('2025-04-10', '0x062c5432107e3b9ad924512209a7468b5c200fcd', 61, 2848.1817, 0.06, 5137.5, 5137.44, 98, 508, 710),('2025-04-10', '0x7760e0243ca9baa630412865df7b39afba42ff0f', 62, 2844.5139, 18.14, 0, -18.14, 198, 1773, 2004),('2025-04-10', '0x2f53e033c55eb6c87cea259123c0a68ca3578426', 63, 2590.1052, 0, 0, 0, 1, 8254, 16330),('2025-04-10', '0x525b8ecd160b60a2a08c4880dfa2a4a3858c0b41', 64, 2508.0436, 79, 66.61, -12.39, 243, 503, 826),('2025-04-10', '0x9af481276b075e036bc23e887a8bd275e69ef74c', 65, 2459.6701, 255.72, 441.75, 186.03, 375, 1492, 2996),('2025-04-10', '0x0008d343091ef8bd3efa730f6aae5a26a285c7a2', 66, 2457.1453, 1945.01, 1474.52, -470.49, 1638, 383108, 403294),('2025-04-10', '0xdde8df9a7dc9f68bdac815f493d1d731de911b5a', 67, 2453.7036, 143.18, 2953.58, 2810.4, 1216, 2603, 7470),('2025-04-10', '0x3eb879cc9a0ef4c6f1d870a40ae187768c278da2', 68, 2423.0793, 0, 0, 0, 47, 1286, 93804),('2025-04-10', '0x6301add4fb128de9778b8651a2a9278b86761423', 69, 2388.1195, 976.48, 2543.63, 1567.15, 1774, 11606, 22279),('2025-04-10', '0x728b3de78c3bd3e9c970524ca6aae1f8d6a61996', 70, 2387.8603, 5058.94, 5101.9, 42.96, 307, 5108, 12219),('2025-04-10', '0x0000000000000000000000000000000000000001', 71, 2346.6329, 0, 0, 0, 559, 32152, 33055),('2025-04-10', '0xf5a4ba515dd36a42e9634a3ac1f1c58fa24d3acd', 72, 2249.8878, 87.74, 223.49, 135.75, 125, 604, 847),('2025-04-10', '0x530afa101bed324809d0738d45b38a669314ff54', 73, 2196.1776, 67.15, 41.9, -25.25, 169, 1441, 1534),('2025-04-10', '0x9a15342876e19052c3fabcef9bad8507b9623c12', 74, 2116.1269, 234.7, 189.36, -45.34, 121, 324, 948),('2025-04-10', '0xefcbc56e48d51b9d93d647ba7bfa501eb3aac398', 75, 2107.196, 87.75, 126.05, 38.3, 1532, 15384, 21700),('2025-04-10', '0xbe2ad1d87b3c783c56de71718588fc4c0ce705b2', 76, 2009.6609, 4.1, 0.18, -3.92, 231, 1372, 2012),('2025-04-10', '0x05f9469db4530d9492af07fb064de2af8c48554a', 77, 2002.4703, 14.62, 6.1, -8.52, 71, 329, 492),('2025-04-10', '0x24e267d13314dd742d86c3321e727b801ed99542', 78, 1977, 0, 0, 0, 51, 99, 427),('2025-04-10', '0x0d388658633418e8e51a7cf67c7059f863f053d9', 79, 1920.6633, 890.06, 433.23, -456.83, 207, 2453, 8759),('2025-04-10', '0xff36ff458b51dcd034598c56f65a8491427dc572', 80, 1913.6122, 0.78, 0.45, -0.33, 60, 357, 445),('2025-04-10', '0xeea89c8843e8beb56e411bb4cac6dbc2d937ee1d', 81, 1886.7889, 0, 109.98, 109.98, 2913, 83845, 85012),('2025-04-10', '0x2cc12318de28edc9c753f7cb22100890af630c2d', 82, 1870.8971, 0, 0, 0, 59, 297, 327),('2025-04-10', '0x78f0269f5b1ca914c8c58993f41181f89e212b27', 83, 1863.7962, 4318.54, 4915.88, 597.34, 1006, 3802, 7355),('2025-04-10', '0xb4d3c81418a32b6c8dbb6462bbed26ab16884e92', 84, 1838.4589, 88.45, 127.86, 39.41, 238, 1393, 5349),('2025-04-10', '0x9f7064dfe6ca5856b3afd7a3b3974686a35bdab5', 85, 1820.6204, 308.48, 295.79, -12.69, 715, 2788, 5510),('2025-04-10', '0x30762e2624c4b97d84bd69ba6527a4c00f30826d', 86, 1806.6236, 312.57, 247.15, -65.42, 71, 335, 525),('2025-04-10', '0x39fb2a042217ea9e03ec0cc345b5dcf59f17d9f7', 87, 1800.9645, 0.35, 0.56, 0.21, 145, 1307, 1337),('2025-04-10', '0xfa3ce71036dd4564d7d8de19d2b90fb856c5be82', 88, 1796.1033, 0, 0, 0, 3, 1001, 15493),('2025-04-10', '0x4b4b7a4008718415c54e41398448421643b2aa61', 89, 1785.1432, 41.12, 82.01, 40.89, 251, 2394, 4582),('2025-04-10', '0xf52393e120f918ffba50410b90a29b1f8250c879', 90, 1724.2894, 6070.22, 3831.12, -2239.1, 925, 8838, 15107),('2025-04-10', '0x00b278dd68f9d8491795ffaf771120638bef1686', 91, 1715.41, 51.89, 5377.61, 5325.72, 832, 3276, 9237),('2025-04-10', '0xc6400a5584db71e41b0e5dfbdc769b54b91256cd', 92, 1624.1549, 109.71, 0, -109.71, 1904, 7514, 21149),('2025-04-10', '0xe7513e5595a751af9f298ecea7741cdd839dc7d4', 93, 1606.7036, 98.76, 73.58, -25.18, 388, 1406, 3280),('2025-04-10', '0xd13f1a15d9815745d071fe812df08cc99c6a728f', 94, 1600.0819, 81.84, 101.15, 19.31, 8, 23, 287),('2025-04-10', '0x005734d7d408bccf41cff34b46244551d01f0a6b', 95, 1599.656, 0.31, 0, -0.31, 172, 1273, 1376),('2025-04-10', '0xcd4fec10c8ad4873e209062b31defb684ff8cb7c', 96, 1596.5075, 81.54, 71.26, -10.28, 377, 6966, 10837),('2025-04-10', '0xda3863583c9fcd8a5d3506d91aaf33157124d1d1', 97, 1547.0088, 54.93, 21.72, -33.21, 2813, 30067, 32782),('2025-04-10', '0x29f1abd903f2293d062307d1ff4e25697a05986f', 98, 1533.1986, 0, 2.27, 2.27, 257, 870, 1052),('2025-04-10', '0x0e642e32974470085e362fe76de5c43330632bdb', 99, 1529.99, 57.79, 137.24, 79.45, 404, 5107, 13279),('2025-04-10', '0x98e711f31e49c2e50c1a290b6f2b1e493e43ea76', 100, 1528.1262, 0, 0, 0, 723, 3842, 5258)
;
